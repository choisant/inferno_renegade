<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Example of use: inferences for Parkinson’s Disease</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Example of use: inferences for Parkinson’s
Disease</h1>



<div id="purpose" class="section level2">
<h2>Purpose</h2>
<p>Here is a toy example showing some kinds of results that can be
obtained with Bayesian nonparametric exchangeable inference. The example
involves inferences about some investigations on Parkinson’s Disease
described in the paper by <a href="https://doi.org/10.1016/j.cmet.2022.02.001">Brakedal &amp;
al. (2022)</a>, which generously and professionally shares its <a href="https://www.cell.com/cms/10.1016/j.cmet.2022.02.001/attachment/82e51142-50b8-4f84-a3e0-7c08d641a47b/mmc2.xlsx">data</a>.</p>
<p>The investigations in the cited paper involve 30 subjects, for each
of which various data are collected. Fifteen of these subjects belong to
a control group, the other 15 to the treatment group, denoted
<code>NR</code>. This group received a nicotinamide adenine dinucleotide
(NAD) replenishment therapy, via oral intake of nicotinamide riboside
(NR). In this toy example we do not follow or reproduce the paper’s
investigations, nor do we use all the variates observed. We limit
ourselves to 7 variates for each subject. Here is a list with a brief
description of each:</p>
<div id="treatment-group" class="section level4">
<h4>Treatment group</h4>
<p><em>Binary</em> variate with values <code>Placebo</code> and
<code>NR</code>.</p>
</div>
<div id="sex" class="section level4">
<h4>Sex</h4>
<p><em>Binary</em> variate with values <code>Female</code> and
<code>Male</code>.</p>
</div>
<div id="age" class="section level4">
<h4>Age</h4>
<p><em>Integer</em> variate.</p>
</div>
<div id="anamnestic-loss-of-smell" class="section level4">
<h4>Anamnestic loss of smell</h4>
<p><em>Binary</em> variate with values <code>No</code> and
<code>Yes</code>.</p>
</div>
<div id="history-of-rem-sleep-behaviour-disorder" class="section level4">
<h4>History of REM sleep behaviour disorder</h4>
<p><em>Binary</em> variate with values <code>No</code> and
<code>Yes</code>.</p>
</div>
<div id="mds-updrs-iii-score-at-the-first-subject-visit" class="section level4">
<h4>MDS-UPDRS-III score at the first subject visit</h4>
<p>The <a href="https://www.movementdisorders.org/MDS-Files1/PDFs/Rating-Scales/MDS-UPDRS_English_FINAL.pdf">MDS-UPDRS-III</a>
(Movement Disorder Society’s Unified Parkinson’s Disease Rating Scale)
is one of a set of <em>ordinal</em> scales to assess a subject’s degree
of disability and monitor it over time. The scale III ranges from
<code>0</code> (no disability) to <code>132</code> (highest degree of
disability). Given that operations such as sum or average are performed
on these scales in the literature, the scales should be considered on an
<em>interval</em> kind rather than simply ordinal.</p>
</div>
<div id="difference-in-mds-updrs-iii-scores-between-second-and-first-visit" class="section level4">
<h4>Difference in MDS-UPDRS-III scores between second and first
visit</h4>
<p><em>Ordinal</em> variate, the difference of the previous one between
the subject’s second and first visit. Its range is therefore from
<code>-132</code> to <code>+132</code>, <em>negative</em> values
representing an <em>improvement</em>.</p>
<p><br />
</p>
<p>We store the name of the datafile:example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>datafile <span class="ot">&lt;-</span> <span class="st">&#39;toydata.csv&#39;</span></span></code></pre></div>
<p>Here are the values for two subjects:</p>
<table>
<colgroup>
<col width="10%" />
<col width="5%" />
<col width="2%" />
<col width="18%" />
<col width="28%" />
<col width="21%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">TreatmentGroup</th>
<th align="left">Sex</th>
<th align="right">Age</th>
<th align="left">Anamnestic.Loss.of.smell</th>
<th align="left">History.of.REM.Sleep.Behaviour.Disorder</th>
<th align="right">MDS.UPDRS..Subsection.III.V1</th>
<th align="right">diff.MDS.UPRS.III</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Placebo</td>
<td align="left">Male</td>
<td align="right">66</td>
<td align="left">No</td>
<td align="left">No</td>
<td align="right">44</td>
<td align="right">-2</td>
</tr>
<tr class="even">
<td align="left">NR</td>
<td align="left">Female</td>
<td align="right">65</td>
<td align="left">Yes</td>
<td align="left">No</td>
<td align="right">32</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
</div>
<div id="natural-vs-controlled-or-biased-variates" class="section level3">
<h3>“Natural” vs controlled or “biased” variates</h3>
<p>For the purpose of drawing scientific inferences, it is extremely
important to be mindful of which variates in the dataset have “natural”
statistics, and which instead have statistics controlled by the observer
– and are therefore “biased”. This distinction is important because the
dataset statistics of the controlled variates may then <em>not</em> be
representative of the naturally-occurring ones, and therefore cannot be
used for inference purposes.</p>
<p>In the present dataset, for instance, the numbers of
<code>Placebo</code> and <code>NR</code> subjects were decided by the
investigators to be in a 50%/50% proportion. Obviously this is not a
naturally occurring proportion; in fact, it does not even make sense of
speaking of a naturally occurring statistics for this
<code>TreatmentGroup</code> variate.</p>
<p>For the <code>Sex</code> variate, the dataset has a proportion of
around 17% <code>Female</code> and 83% <code>Male</code> subjects. This
proportion also partly stems from the selection procedure of the
investigators, so we cannot infer that roughly 16% of Parkinson patients
in the national population are females. It is also possible that the
proportions in the <code>Age</code> variate may depend on the selection
procedure.</p>
<p>On the other hand, the investigators did <em>not</em> choose the
statistics of the two <code>MDS.UPDRS</code> variates, within the groups
having particular values of the other variates. This
<em>conditional</em> or <em>subpopulation</em> statistics can be taken
as representatives of naturally-occurring ones (see <a href="https://doi.org/10.1214/aos/1176345331">Lindley &amp; Novick
(1980)</a> for a brilliant discussion of this point).</p>
<p><em>(add short explanation of exchangeability)</em></p>
</div>
</div>
<div id="metadata" class="section level2">
<h2>Metadata</h2>
<p>Let’s load the package:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(inferno)</span></code></pre></div>
<p>In order to draw inferences, we need metadata information, that is,
information about the variates that is <em>not</em> present in the data.
Such information mainly regard the kind and domain of each variate.</p>
<p>As an example of why metadata is necessary, suppose you are given the
data <code>3</code>, <code>7</code>, <code>9</code>. Can you say whether
the value <code>5</code> could be observed in a new instance? and what
about <code>4.7</code>, or <code>-10</code>? Knowing whether these
values are at all possible, or not, greatly affects the precision of the
inferences we draw. Obviously a researcher must know such basic
information about the data being collected – otherwise they wouldn’t
know what they’re doing.</p>
<p>The software requires specification of metadata either as a
<code>data.frame</code> object or as a <code>.csv</code> file. To help
you prepare this file, the software offers the function
<code>buildmetadata()</code>, which writes a template that you
thereafter modify. The template is filled with
<strong>tentative</strong> values; these are wild guesses from the data,
so they are often wrong. The function explains the heuristic it is using
in order to pre-fill the fields of the metadata file, and gives warnings
about guessed values that are especially dubious. You should examine and
correct all fields:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">buildmetadata</span>(<span class="at">data =</span> datafile, <span class="at">file =</span> <span class="st">&#39;temp_metadata&#39;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; Analyzing 7 variates for 30 datapoints.</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; * &quot;TreatmentGroup&quot; variate:</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;   -  2 different  values detected:</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt;  &quot;NR&quot;, &quot;Placebo&quot; </span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt;   which do not seem to refer to an ordered scale.</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;   Assuming variate to be NOMINAL.</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; * &quot;Sex&quot; variate:</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt;   -  2 different  values detected:</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt;  &quot;Female&quot;, &quot;Male&quot; </span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt;   which do not seem to refer to an ordered scale.</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt;   Assuming variate to be NOMINAL.</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; * &quot;Age&quot; variate:</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt;   - Numeric values between 29 and 75 </span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt;   Assuming variate to be CONTINUOUS.</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co">#&gt;   - Distance between datapoints is a multiple of 1 </span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co">#&gt;   Assuming variate to be ROUNDED.</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="co">#&gt;   - All values are positive</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#&gt;   Assuming &quot;domainmin&quot; to be 0</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co">#&gt; * &quot;Anamnestic.Loss.of.smell&quot; variate:</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="co">#&gt;   -  2 different  values detected:</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="co">#&gt;  &quot;No&quot;, &quot;Yes&quot; </span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co">#&gt;   which do not seem to refer to an ordered scale.</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="co">#&gt;   Assuming variate to be NOMINAL.</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="co">#&gt; * &quot;History.of.REM.Sleep.Behaviour.Disorder&quot; variate:</span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="co">#&gt;   -  2 different  values detected:</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="co">#&gt;  &quot;No&quot;, &quot;Yes&quot; </span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="co">#&gt;   which do not seem to refer to an ordered scale.</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="co">#&gt;   Assuming variate to be NOMINAL.</span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a><span class="co">#&gt; * &quot;MDS.UPDRS..Subsection.III.V1&quot; variate:</span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a><span class="co">#&gt;   - Numeric values between 15 and 50 </span></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a><span class="co">#&gt;   Assuming variate to be CONTINUOUS.</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a><span class="co">#&gt;   - Distance between datapoints is a multiple of 1 </span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a><span class="co">#&gt;   Assuming variate to be ROUNDED.</span></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a><span class="co">#&gt;   - All values are positive</span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a><span class="co">#&gt;   Assuming &quot;domainmin&quot; to be 0</span></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a><span class="co">#&gt; * &quot;diff.MDS.UPRS.III&quot; variate:</span></span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a><span class="co">#&gt;   - Numeric values between -9 and 10 </span></span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a><span class="co">#&gt;   Assuming variate to be CONTINUOUS.</span></span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a><span class="co">#&gt;   - Distance between datapoints is a multiple of 1 </span></span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a><span class="co">#&gt;   Assuming variate to be ROUNDED.</span></span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a><span class="co">#&gt; =========</span></span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a><span class="co">#&gt; WARNINGS - please make sure to check these variates in the metadata file:</span></span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a><span class="co">#&gt; * &quot;Age&quot; variate appears to be continuous and rounded,</span></span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a><span class="co">#&gt; but it could also be an ordinal variate</span></span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a><span class="co">#&gt; * &quot;MDS.UPDRS..Subsection.III.V1&quot; variate appears to be continuous and rounded,</span></span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a><span class="co">#&gt; but it could also be an ordinal variate</span></span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a><span class="co">#&gt; * &quot;diff.MDS.UPRS.III&quot; variate appears to be continuous and rounded,</span></span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a><span class="co">#&gt; but it could also be an ordinal variate</span></span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a><span class="co">#&gt; =========</span></span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a><span class="co">#&gt; Saved proposal metadata file as &quot;temp_metadata.csv&quot;</span></span></code></pre></div>
<p>We can open the temporary metadata file
<code>temp_metadata.csv</code> and edit it with any software of our
choice. Let’s save the corrected version as
<code>meta_toydata.csv</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>metadatafile <span class="ot">&lt;-</span> <span class="st">&#39;meta_toydata.csv&#39;</span></span></code></pre></div>
<p>The metadata are as follows; <code>NA</code> indicate empty
fields:</p>
<table>
<colgroup>
<col width="33%" />
<col width="9%" />
<col width="7%" />
<col width="8%" />
<col width="8%" />
<col width="10%" />
<col width="10%" />
<col width="5%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">type</th>
<th align="right">datastep</th>
<th align="right">domainmin</th>
<th align="right">domainmax</th>
<th align="left">minincluded</th>
<th align="left">maxincluded</th>
<th align="left">V1</th>
<th align="left">V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TreatmentGroup</td>
<td align="left">nominal</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NR</td>
<td align="left">Placebo</td>
</tr>
<tr class="even">
<td align="left">Sex</td>
<td align="left">nominal</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">Female</td>
<td align="left">Male</td>
</tr>
<tr class="odd">
<td align="left">Age</td>
<td align="left">continuous</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Anamnestic.Loss.of.smell</td>
<td align="left">nominal</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">No</td>
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">History.of.REM.Sleep.Behaviour.Disorder</td>
<td align="left">nominal</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">No</td>
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">MDS.UPDRS..Subsection.III.V1</td>
<td align="left">ordinal</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">132</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">diff.MDS.UPRS.III</td>
<td align="left">ordinal</td>
<td align="right">1</td>
<td align="right">-132</td>
<td align="right">132</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<p>For a description of the metadata fields, see the help for
<code>metadata</code> with <code>?inferno::metadata</code>.</p>
<p><em>(More to be written here!)</em></p>
</div>
<div id="learning" class="section level2">
<h2>Learning</h2>
<p>Our inferences will be based on the data already observed, and will
mainly take the form of <em>probabilities</em> about the unkonwn values
various quantities <span class="math inline">\(Y\)</span>, given the
observed values of other quantities <span class="math inline">\(X\)</span>: <span class="math display">\[
\mathrm{Pr}(Y = y \:\vert\: X = x, \mathrm{data})
\]</span> As the notation above indicates, <em>these probabilities also
depend on the <span class="math inline">\(\mathrm{data}\)</span> already
observed</em>. They are usually called “posterior probabilities”.</p>
<p>We need to prepare the software to perform calculations of posterior
probabilities given the observed data. In machine learning an analogous
process is called “learning”. For this reason the function that achieves
this is called <code>learn()</code>. It requires at least three
arguments:</p>
<ul>
<li><code>data</code>, which can be given as a path to the
<code>csv</code> file containing the data</li>
<li><code>metadata</code>, which can also be given as a path to the
metadata file</li>
<li><code>outputdir</code>: the name of the directory where the output
should be saved.</li>
</ul>
<p>It may be useful to specify two more arguments:</p>
<ul>
<li><code>seed</code>: the seed for the random-number generator, to
ensure reproducibility</li>
<li><code>parallel</code>: the number of CPUs to use for the
computation</li>
</ul>
<p>Alternatively you can set the seed with <code>set.seed()</code>, and
start a set of parallel workers with the
<code>parallel::makeCluster()</code> and
<code>doParallel::registerDoParallel()</code> commands.</p>
<p>The “learning” computation can take tens of minutes, or hours, or
even days depending on the number of variates and data in your inference
problem. The <code>learn()</code> function outputs various messages on
how the computation is proceeding. As an example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>learnt <span class="ot">&lt;-</span> <span class="fu">learn</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>    <span class="at">data =</span> datafile,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="at">metadata =</span> metadatafile,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="at">outputdir =</span> <span class="st">&#39;parkinson_computations&#39;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">16</span>,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    <span class="at">parallel =</span> <span class="dv">12</span>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; Registered doParallelSNOW with 12 workers</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt;</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; Using 30 datapoints</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; Calculating auxiliary metadata</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt;</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; ************************** </span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; Saving output in directory</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; parkinson_computations</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; ************************** </span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; Starting Monte Carlo sampling of 3600 samples by 60 chains</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; in a space of 703 (effectively 6657) dimensions.</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; Using 12 cores: 60 samples per chain, 5 chains per core.</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; Core logs are being saved in individual files.</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt;</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; C-compiling samplers appropriate to the variates (package Nimble)</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt; this can take tens of minutes with many data or variates.</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="co">#&gt; Please wait...</span></span></code></pre></div>
<p>At the end of the computation the <code>learn()</code> function
returns the name of the directory in which the results are saved. In the
code snipped above, this name is saved in the variable
<code>learnt</code>. The object containing the information needed to
make inferences is the <code>learnt.rds</code> file within this
directory.</p>
</div>
<div id="drawing-inferences" class="section level2">
<h2>Drawing inferences</h2>
<p>We are finally ready to use the software for drawing inferences,
testing hypotheses, and similar scientific investigations. From the
observed data, the software allows us to find the probability of any
question or hypothesis of interest. It is important, though, that the
hypothesis be stated in an unambiguous, quantitative form.</p>
<p>For example, we might want to ask: “Does the NAD-replenishment
therapy have an effect on females?”. At first this may sound like a
valid scientific hypothesis. But if we carefully examine the statement
we realize that it is too vague. First, what does “having an effect”
mean exactly? how can this be quantified? Second, can we really say that
the therapy either has or has not an effect? are there no degrees of
efficacy involved? Third, whom are we asking this question about? the
next patient that we may see? or the population of all the remaining
patients? Let us make our initial question quantitatively clear.</p>
<p>First, let us translate “effect” into the difference in MDS-UPDRS-III
scores between the first and second visits of a subject (visit 2 <span class="math inline">\(-\)</span> visit 1), represented by the variate
<code>diff.MDS.UPRS.III</code>. Note that other choices could be made,
such as the difference in another MDS-UPDRS score (I–IV), or in the
total of these scores, or as the ratio rather than the difference – or
as some other variate altogether.</p>
<p>Second, instead of asking the unrealistic dichotomous question “has
or has not?”, we ask how strong the effect is, as quantified by the
value of the MDS-UPDRS-III decrease.</p>
<p>Third, let us ask this question about a possible next patient. We
shall see that this question is also related to the population as a
whole.</p>
<p>We can calculate the probability that, in the next patient, we shall
observe any particular value <span class="math inline">\(y\)</span> of
the MDS-UPDRS-III difference, given that the patient is Female, and
given what has been observed in the clinical trials: <span class="math display">\[
\mathrm{Pr}(\text{MDS-UPDRS-III difference} = y \:\vert\:
\text{Sex} = \text{Female}, \text{Treatment group} = \text{NR},
\mathrm{data})
\]</span></p>
<p>The function for this is <code>Pr(X, Y, learnt)</code>, which accepts
three arguments:</p>
<ul>
<li><code>Y</code>: the variates and values of which we want the
probability</li>
<li><code>X</code>: the variates and values which are known</li>
<li><code>learnt</code>: the knowledge acquired from the dataset</li>
</ul>
<p>Let us first ask this for a specific value of the MDS-UPDRS-III
difference, let’s say <code>0</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>probability <span class="ot">&lt;-</span> <span class="fu">Pr</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">data.frame</span>(<span class="at">diff.MDS.UPRS.III =</span> <span class="dv">0</span>),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    <span class="at">X =</span> <span class="fu">data.frame</span>(<span class="at">Sex =</span> <span class="st">&#39;Female&#39;</span>, <span class="at">TreatmentGroup =</span> <span class="st">&#39;NR&#39;</span>),</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>    <span class="at">learnt =</span> learnt</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; No parallel backend registered.</span></span></code></pre></div>
<p>The output of the <code>Pr()</code> function is a list of three
objects, of which we discuss only two for the moment:</p>
<ul>
<li><strong><code>value</code></strong>: this is the value of the
probability we wanted to know. In this case it is</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>probability<span class="sc">$</span>value</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt;       X</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; Y          [,1]</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt;   [1,] 0.064202</span></span></code></pre></div>
<p>that is, there is approximately a 6% probability that the next
treated female patient will have a MDS-UPDRS-III difference of exactly
0.</p>
<ul>
<li><strong><code>quantiles</code></strong>: these two values tell us
how much the probability could change, if your knowledge were updated by
more clinical trials. They thus quantify the uncertainty of our present
probabilistic conclusions. An future, updated probability has a 90%
probability of lying between the two quantile values. In this case they
are</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>probability<span class="sc">$</span>quantiles</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; , ,  = 5%</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt;       X</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; Y           [,1]</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;   [1,] 0.0282597</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; , ,  = 95%</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt;       X</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; Y          [,1]</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt;   [1,] 0.113917</span></span></code></pre></div>
<p>that is, if we had many more clinical trials, the probability above
could change to a value within around 3% and 10%.</p>
<p><em>(TO BE CONTINUED)</em></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
