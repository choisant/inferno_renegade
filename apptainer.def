BootStrap: docker
From: ubuntu:22.04

# Image for running the tests in modelfreeinference

%files
	/etc/localtime
	/etc/timezone

%environment
	export LC_ALL="en_US.UTF-8"
	export R_LIBS_USER=R-packages

%post
	# Install software
	apt-get update -y
	apt-get install -y language-pack-en-base
	apt-get install curl -y
	apt-get install git -y
	apt-get install xml2 -y
	apt-get install libfontconfig1-dev -y
	apt-get install libharfbuzz-dev libfribidi-dev -y
	apt-get install libfreetype6-dev libpng-dev libtiff5-dev libjpeg-dev -y
	# Get newest version of R
	printf "y\n8\n36\n" | apt-get install r-base
	apt-get install r-base-dev -y
	apt install build-essential libcurl4-openssl-dev libssl-dev libxml2-dev	
	Rscript -e "install.packages('devtools')"

%runscript
	# Install modelfreeinference
	mkdir R-packages
	export R_LIBS=R-packages
	export R_LIBS_USER=R-packages
	if [-d R-packages/modelfreeinference]; then
		echo "Package modelfreeinference is already installed. Removing it... \n"
		rm R-packages/modelfreeinference -rf
	fi
	Rscript -e "devtools::install()"
	Rscript -e "library('modelfreeinference')"
	if [ $? -eq 0 ]; then
        echo "Package modelfreeinference has been installed."
    else
        echo "Package modelfreeinference has not been installed."
        exit 1
    fi


